{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container">
    <div class="content-section">
       <div>
        <img class="avatar" src="{{ user.profile.image.url }}">
       </div>
     <!--main container-->
     <div class="row profileBody marginTop">
         <!--details section-->
         <div class="col-md-4">
             <div class="row">
                 <div class="col-12">
                    <form method="POST" enctype="multipart/form-data">
                          {% csrf_token %}
                          <fieldset class="form-group">
                              <legend class="border-bottom mb-4">Profile Info</legend>
                              {{ u_form|crispy }}
                              {{ p_form|crispy }}
                              <div class="form-group text-center">
                                  <button class="submit-btn" type="submit">Update</button>
                              </div>
                          </fieldset>
                    </form>
                </div>
                 <div class="col-12">
                     <h3 class="border-bottom mb-4">My Orders</h3>
                        {% if orders %}
                          {% for order in orders %}
                          <div class="mycard">
                              <div class="row">
                                  <div class="col mycard-title">Order No. {{ order.id }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">TYPE</div>
                                  <div class="col-8">{{ order.type }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">Desc.</div>
                                  <div class="col-8"><p>{{ order.description }}</p></div>
                              </div>
       
   
                                
            
                          </div>
              
                         {% endfor %}
                        {% else %}
                          <p>No orders made yet!</p>
                        {% endif %}
                 </div>
             </div>
         </div>
         <!--designs section-->
         <div class="col-md-8">
            <div class="col-12"><h2 class="border-bottom mb-4">Designs</h2></div>
            <div class="col-12 mb-4">
            {% if designs %}
            <h5>Designs Pending Approval:</h5>
       
               {% for design in designs %}
                   {% if design.order_stage == "Design pending approval"  %}
                         <div class="mycard">
                              <div class="row">
                                  <div class="col mycard-title">Order no. {{ design.order_number }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">TYPE</div>
                                  <div class="col-8">{{ design.type }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">Desc.</div>
                                  <div class="col-8"><p>{{ design.description }}</p></div>
                              </div>
                                <img class="mycard-img" src="{{ design.preview_image.url}}">
                                <div class="button-container">
                                <a class="view-btn text-center"  href="{% url 'design-detail' parameter=design.id %}" class="card-link">View Design</a>
                                <a href="{% url 'request-changes' parameter=design.id %}" class="view-brn">Request Revisions</a></a>
                                </div>
                          </div>
              
                     {% elif design.order_stage == "Revisions requested"  %}
                     
                            <div class="mycard">
                              <div class="row">
                                  <div class="col mycard-title">Order no. {{ design.order_number }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">TYPE</div>
                                  <div class="col-8">{{ design.type }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">Desc.</div>
                                  <div class="col-8"><p>{{ design.description }}</p></div>
                              </div>
                                <img class="mycard-img" src="{{ design.preview_image.url}}">
                                <div class="button-container">
                                <a class="view-btn text-center"  href="{% url 'design-detail' parameter=design.id %}" class="card-link">View Design</a>
                                <a class="view-btn text-center" href="#/">Revisions requested</a>
                                </div>
                          </div>
              

                    {% endif %}
                {% endfor %}
            {% else %}
                       <p>No designs pending approval</p>

            {% endif %}
             
                </div>
                <div class="col-12">
                    <h5>Approved Designs:</h5>
                    
    {% if designs %}
      {% for design in designs %}
        {% if design.order_stage == "Design accepted"  %} 
        
                           <div class="mycard">
                              <div class="row">
                                  <div class="col mycard-title">Order no. {{ design.order_number }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">TYPE</div>
                                  <div class="col-8">{{ design.type }}</div>
                              </div>
                              <div class="row">
                                  <div class="col-4 mycard-category">Desc.</div>
                                  <div class="col-8"><p>{{ design.description }}</p></div>
                              </div>
                                <img class="mycard-img" src="{{ design.preview_image.url}}">
                                <div class="button-container">
                                <a class="view-btn text-center"  href="{% url 'design-detail' parameter=design.id %}" class="card-link">View Design</a>
                                <a class="view-btn text-center" href="{% url 'testimonial' parameter=design.id %}">Write Testimonial</a>
                                </div>
                          </div>
                          
        {% else %}
            <p>No completed designs available</p>
        {% endif %}
      {% endfor %}
    {% else %}
        <div class="col">
            <p>No completed designs</p>
        </div>
    {% endif %}
</div>
             </div>
         </div>
    </div>
</div>
{% endblock content %} 